const browserAPI="undefined"!=typeof browser?browser:chrome;function updateStats(){browserAPI.runtime.sendMessage({type:"UPDATE_STATS"},(e=>{e&&(document.getElementById("total-topics").textContent=e.topics,document.getElementById("total-messages").textContent=e.messages)}))}function loadSettings(){browserAPI.runtime.sendMessage({type:"LOAD_SETTINGS"},(e=>{e&&(document.getElementById("auto-topic").value=e.autoTopic,document.getElementById("topic-position").value=e.topicPosition)}))}function saveSettings(){const e={autoTopic:document.getElementById("auto-topic").value,topicPosition:document.getElementById("topic-position").value};browserAPI.runtime.sendMessage({type:"SAVE_SETTINGS",settings:e},(e=>{e?.success&&console.log("[Topic Manager] Settings saved successfully")}))}function updateChatTitle(){browserAPI.runtime.sendMessage({type:"GET_CURRENT_CHAT_TITLE"},(e=>{const t=document.getElementById("chat-title");t&&(t.textContent=e?.title||"No chat selected")}))}browserAPI||console.error("[Topic Manager] Browser API (chrome or browser) not available. Popup will not function."),document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("chat-title")?(updateStats(),loadSettings(),updateChatTitle(),document.getElementById("auto-topic").addEventListener("change",saveSettings),document.getElementById("topic-position").addEventListener("change",saveSettings),browserAPI.runtime.onMessage.addListener((e=>{"CHAT_CHANGED"===e.type&&updateChatTitle()})),setInterval(updateChatTitle,2e3)):console.error("[Topic Manager] Chat title element not found in popup")}));